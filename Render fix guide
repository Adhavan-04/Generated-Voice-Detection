# ğŸ”§ Render Deployment Fix Guide

## The Problem
You're getting a Python 3.13 compatibility error. This is because Render is using Python 3.13 by default, but some audio processing libraries aren't fully compatible yet.

## âœ… Solution: 3 Options (Try in Order)

---

## Option 1: Force Python 3.11 (RECOMMENDED)

### Step 1: Add runtime.txt to your repository
Create a file named `runtime.txt` with this content:
```
python-3.11.8
```

### Step 2: Update requirements.txt
Replace your current requirements.txt with:
```
Flask==3.0.3
librosa==0.10.2
numpy==1.26.4
scipy==1.13.0
soundfile==0.12.1
numba==0.59.1
llvmlite==0.42.0
setuptools==69.5.1
gunicorn==22.0.0
```

### Step 3: Push to GitHub
```bash
git add runtime.txt requirements.txt
git commit -m "Fix Python version for Render"
git push
```

### Step 4: Redeploy on Render
Render will automatically redeploy. If not, click "Manual Deploy" â†’ "Clear build cache & deploy"

---

## Option 2: Use Render Environment Variable

In Render Dashboard:
1. Go to your service
2. Click "Environment" tab
3. Add environment variable:
   - **Key**: `PYTHON_VERSION`
   - **Value**: `3.11.8`
4. Click "Save Changes"
5. Redeploy

---

## Option 3: Try Railway.app Instead (Easier!)

Railway often handles dependencies better:

### Step 1: Go to railway.app
1. Sign up with GitHub
2. Click "New Project"
3. Select "Deploy from GitHub repo"
4. Choose your repository

### Step 2: Add Environment Variable
In Railway dashboard:
- Add variable: `API_KEY` = `your_secure_api_key_here_123456`

### Step 3: Done!
Railway will auto-deploy. Get your URL from the dashboard.

---

## Option 4: Use Simplified Requirements

If issues persist, try this minimal `requirements.txt`:

```txt
Flask>=3.0.0
librosa>=0.10.0
numpy>=1.24.0,<2.0.0
scipy>=1.11.0
soundfile>=0.12.0
gunicorn>=21.0.0
```

This uses flexible version ranges that pip can resolve better.

---

## ğŸ¯ Quickest Solution (5 minutes)

**Use Railway.app instead of Render:**

1. Go to https://railway.app
2. Click "Start a New Project"
3. Click "Deploy from GitHub repo"
4. Select your repo
5. Wait 3-5 minutes
6. Get your URL!

Railway handles Python dependencies automatically and usually "just works" without these issues.

---

## Files to Upload

I've created these updated files for you:
- `runtime.txt` - Forces Python 3.11
- `requirements.txt` - Updated with compatible versions
- `requirements_simple.txt` - Backup minimal version

---

## Testing After Fix

Once deployed, test:
```bash
# Health check
curl https://your-app-url.com/health

# Should return: {"status": "healthy", ...}
```

---

## Alternative: Deploy Locally First

If still having issues, run locally to verify:

```bash
# Create virtual environment with Python 3.11
python3.11 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install
pip install -r requirements.txt

# Run
python app.py

# Test
curl http://localhost:5000/health
```

If it works locally, the deployment should work too.

---

## Common Render Issues & Fixes

### Issue 1: Build keeps failing
**Fix**: Clear build cache
- Render Dashboard â†’ Settings â†’ "Clear build cache & deploy"

### Issue 2: Python version not changing
**Fix**: Make sure runtime.txt is in root directory
```
your-repo/
  â”œâ”€â”€ app.py
  â”œâ”€â”€ runtime.txt  â† Must be here
  â”œâ”€â”€ requirements.txt
  â””â”€â”€ Procfile
```

### Issue 3: Librosa won't install
**Fix**: Add system dependencies
In Render Dashboard â†’ Settings â†’ Add Build Command:
```bash
apt-get update && apt-get install -y libsndfile1 && pip install -r requirements.txt
```

---

## Recommended: Switch to Railway

Given the issues with Render, I recommend Railway:

**Pros:**
âœ… Better dependency handling
âœ… Faster builds
âœ… Auto-detects Python apps
âœ… 500 hours/month free
âœ… Simpler configuration

**Cons:**
âŒ Limited to 500 hours/month free tier

**Deploy on Railway:**
```bash
# Install Railway CLI (optional)
npm install -g @railway/cli

# Or use web interface
# 1. Go to railway.app
# 2. Deploy from GitHub
# 3. Done!
```

---

## Emergency: Use Vercel Serverless

If both Render and Railway fail, try Vercel:

### Create vercel.json:
```json
{
  "version": 2,
  "builds": [
    {
      "src": "app.py",
      "use": "@vercel/python"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "app.py"
    }
  ]
}
```

### Deploy:
```bash
npm install -g vercel
vercel --prod
```

---

## Final Recommendation

**For this hackathon, use Railway.app:**
1. Fastest to deploy (5 minutes)
2. Fewer compatibility issues
3. Just worksâ„¢
4. Free tier is generous

**Steps:**
1. Upload code to GitHub
2. Go to railway.app
3. "New Project" â†’ "Deploy from GitHub"
4. Select repo
5. Add API_KEY environment variable
6. Get URL and submit!

---

## Need More Help?

1. Check Render build logs for specific errors
2. Try Railway as alternative
3. Verify all files are in GitHub repo
4. Make sure runtime.txt and requirements.txt are in root directory

Good luck! ğŸš€
